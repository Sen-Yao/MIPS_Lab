# 一、实验要求

- 在数据段定义两个 int 型变量a，b，在数据段定义一个 int 型数组 c[40]，不进行初始化。
- 通过系统功能调用从键盘输入 a，b 的值（不大于20）
- 采用 MIPS 汇编指令实现 c[a+b]=a*b
- 通过系统功能调用分别显示 c[a+b] 所在的存储地址和值
- 指出程序运行结束后，a,b.c[a+b] 所在的数据段，存储位置及其取值，验证程序功能的正确性。

# 二、实验环境

- macOS 下虚拟机搭建的 Windows 11 操作系统 
- MIPS 模拟器: Mars

# 三、设计思路

## 1. 数据定义

根据题目要求，需要定义两个 int 型变量 a，b 和一个有 40 个元素的 int 数组 c，int 类型的数据占用 4 个字节，即一个字，因此用 “.word” 作为数据指令。虽然不要求进行初始化，但是还是需要在数据段作出相应的定义，并对其分配内存空间。

因此代码段为

```
	a: .word 0
	b: .word 0
	c: .word 0:40
```

其中 0:40 表示分配 40 份初值为 0 的空间。另外一方面，题目还要求输出信息，这就需要输出信息具有一定的可读性。因此在这里还需要定义两端文本用于增强输出可读性。

```
	message1 .asciiz The address is 
	message2 .asciiz nThe value is 
```
## 2. 代码段
首先需要读取 a，b 的地址，然后调用系统功能对其进行赋值。这里需要让 \$v0=5，从键盘读取到的值同样也保存在 \$v0，需要将此值存放回 a，b 原来的地址。这样就实现了前三个要求。

然后实现 c[a+b]=a\*b。首先需要把刚才的 a，b 值载入到寄存器中，然后分别进行加法和乘法运算，得到 a+b 和 a\*b 的值，并且存储到临时寄存器中。然后对 a+b 左移两位得到需要的地址偏移量，并且把这个偏移量加在 c 的地址上。这样就得到目标内存地址。现在只需要将刚才求得的 a*b 存进去即可。

最后的要求是输出 c[a+b] 的地址和值。这里通过查找资料得知，为了输出文本，需要将文本存入 \$a0，然后给 \$v0 赋值为4，就可以输出之前数据段定义的文本。为了输出十六进制地址，需要给 \$v0 赋值为 34。

最终代码参见文件 source.asm

# 四、实验总结

在本次实验中，我学会了使用 MIPS 汇编语言实现简单的 C 语言功能，通过算术运算和数据存取指令，同时自己拓展，学会了许多关于系统功能调用的知识，最终实现了要求的功能。将自己在《计算机组成原理与结构技术》的汇编语言中学到的理论知识应用到了实践中，这给我的成就感非常大。
但与此同时，也不可避免的遇到了一些问题。由于使用的是 Arm 架构的电脑，加上系统是 macOS 而非传统的 Windows，我在配置虚拟机，安装 Java 环境以及最终下载 Mars 上都花费了不少时间。同时由于电脑分辨率过高，导致 Mars 的显示效果不理想。最终在实验室中花费不少时间，现场解决了这些问题。这给我的教训是，应该在课前做好预习，提前配置好对应环境。
