# 题目

全部采用 verilog 硬件描达语言设计实现简单指令集 MIPS 微处理器，要求指令存储器在时钟上升沿读出指令指令指针的修改、寄存器文件写入，数据存储器数据写入都在时钟下降沿完成。完成完整设计代码输入、各模块完整功能仿真，整体仿真 ，验证所有指令执行情况。

且假定所有通用寄存器复位时取值都为各自寄存器编号乘以 4；PC寄存器初始值为 0；数据存储器和指令存储器容量大小为 32*32，地址都从 0 开始，指令存储器初始化时装载测试 MIPS 汇编程序的机器指令 ，数据存储器所有存储单元的初始值为其对应地址的取值。需要注意的是数据存储器的地址呈现以下规则：都是 4 的整数倍。

仿真以下 MIPS 汇编语言程序段的执行流程

```asm
main: 
    add $4, $2, $3 
    lw $4, 4($2)
    sw $5, 8($2)
    sub $2, $4, $3
    or $2, $4, $3
    and $2, $4, $3
    slt $2, $4, $3
    jal addf
    beq $3, $3, equ
    lw $4 4($2)
equ:
    beq $3, $4, exit
    sw $2, 0($3)

exit:
    j main
addf: 
    add $5, $5, $5
    jr
```

此外，本人的学号还要求实现 ``jal`` 和 ``jr`` 指令。

# 实现思路

首先根据要求，重新设计了对应的代码

```asm
main: 
    add $4, $2, $3 // 0
    lw $4, 4($2)  // 1
    sw $5, 8($2)  // 2
    sub $2, $4, $3  // 3
    or $2, $4, $3  // 4
    and $2, $4, $3  // 5
    slt $2, $4, $3  // 6
    jal addf  // 7
    beq $3, $3, equ  // 8
    lw $4 4($2)  // 9
equ:
    beq $3, $4, exit // a
    sw $2, 0($3)  // b

exit:
    j main  // c
addf: 
    add $5, $5, $5  // d
    jr  // e
```

# 使用说明

MIPS_CPU 为 Vivado 对应的项目文件夹，其中的 xpr 文件就是 Vivado 的项目文件

代码为 Verilog 格式，存储在 "MIPS_CPU/MIPS_CPU.srcs/sources_1/new" 路径下

# 可能存在问题

注意，如果直接将整个项目导入 Vivado，会出现文件名为红色的情况。这是因为 Vivado 找不到对应的 v 文件造成的。

解决方法就是在红色的文件名上右键，然后 Replace File，找到本项目文件夹所在的位置，并且在 "MIPS_CPU/MIPS_CPU.srcs/sources_1/new" 路径下双击对应名字的 v 文件即可。
